T := $(TARG:%.a=%)

TARG := lib/$(T)/$(T).a

ALL += $(TARG)

OFILES := $(OFILES:%=lib/$(T)/%)

ALLO += $(OFILES)

LIBHFILES := $(LIBDEPS:%=include/%.h)

LIBDEPS := $(shell echo $(LIBDEPS) | 9 sed 's|([a-z]+)|lib/\1/\1\.a|g')

HFILES := $(HFILES:%=lib/$(T)/%) $(LIBHFILES) include/$(T).h

$(TARG): $(OFILES) $(LIBDEPS)
	@echo OFILES: $(OFILES)
	@echo LIBDEPS: $(LIBDEPS)
	$(AR) rsc $@ $(OFILES)

$(OFILES): $(HFILES) $(LIBHFILES)
